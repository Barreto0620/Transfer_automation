<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documenta√ß√£o Transfer Automation</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23e67e22'/><path d='M25 30h50v8H25zm0 16h50v8H25zm0 16h35v8H25z' fill='white'/><path d='M65 62l8-8 8 8-8 8z' fill='white'/></svg>">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <div class="logo-icon">
                    <svg width="34" height="34" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <rect width="100" height="100" fill="#e67e22" rx="8"/>
                        <path d="M20 25h60v8H20zm0 16h60v8H20zm0 16h45v8H20z" fill="white"/>
                        <path d="M70 57l12-12 12 12-12 12z" fill="white"/>
                    </svg>
                </div>
                <span class="logo-text">Transfer Automation</span>
            </div>
            <button class="dark-mode-toggle" onclick="toggleDarkMode()">
                <span id="theme-icon">üåô</span>
                <span id="theme-text">Dark</span>
            </button>
        </header>

        <nav id="sidebar">
            <h1>Documenta√ß√£o</h1>
            <ul>
                <li><a href="#overview">Vis√£o Geral</a></li>
                <li><a href="#chapter1">Cap√≠tulo 1: Interface de Usu√°rio</a></li>
                <li><a href="#chapter2">Cap√≠tulo 2: Orquestrador de Fluxo</a></li>
                <li><a href="#chapter3">Cap√≠tulo 3: Gerenciador de Planilhas</a></li>
                <li><a href="#chapter4">Cap√≠tulo 4: Motor de Automa√ß√£o UI</a></li>
                <li><a href="#chapter5">Cap√≠tulo 5: Handler de Di√°logos</a></li>
                <li><a href="#chapter6">Cap√≠tulo 6: Logging e Relat√≥rios</a></li>
            </ul>
        </nav>

        <main id="main-content">
            <section id="overview" class="overview">
                <h1>Documenta√ß√£o - Transfer Automation</h1>
                <p>O <code>Transfer Automation</code> √© uma ferramenta projetada para <strong>automatizar transfer√™ncias de arquivos em lote</strong> atrav√©s de simula√ß√£o de interface gr√°fica. Ele l√™ instru√ß√µes de transfer√™ncia de uma planilha e usa a√ß√µes simuladas de mouse e teclado para copiar itens de um local e col√°-los em outro, lidando com janelas pop-up como prompts de seguran√ßa ou avisos de "substituir arquivo".</p>
                <hr style="margin: 1.5rem 0;">
                <h2>Vis√£o Geral do Fluxo</h2>
                <div class="mermaid">
                    flowchart TD
                        A0["Motor de Automa√ß√£o UI"]
                        A1["Gerenciador de Planilhas"]
                        A2["Orquestrador de Fluxo de Trabalho"]
                        A3["Logging e Relat√≥rios Operacionais"]
                        A4["Interface de Entrada do Usu√°rio"]
                        A5["Handler de Di√°logos do Windows"]
                        A4 -- "Fornece caminho da planilha" --> A1
                        A4 -- "Fornece credenciais" --> A2
                        A4 -- "Define caminho do log" --> A3
                        A1 -- "Fornece tarefas" --> A2
                        A2 -- "Executa a√ß√µes da UI" --> A0
                        A0 -- "Utiliza handlers de di√°logo" --> A5
                        A2 -- "Atualiza progresso" --> A1
                        A2 -- "Gera relat√≥rios" --> A3
                </div>
            </section>

            <hr>

            <section id="chapter1">
                <h1>Cap√≠tulo 1: Interface de Entrada do Usu√°rio</h1>
                <p>Bem-vindo ao projeto <strong>Transfer Automation</strong>! Esta ferramenta √© projetada para facilitar sua vida automatizando a c√≥pia e colagem de arquivos e pastas baseada em uma lista simples que voc√™ fornece. Mas antes de come√ßar sua m√°gica, ela precisa de algumas informa√ß√µes suas.</p>
                <h3>O que a Interface resolve?</h3>
                <p>Pense nisso como contratar algu√©m para fazer um trabalho - voc√™ primeiro precisa dizer <em>o que</em> fazer e <em>onde</em> encontrar as instru√ß√µes. Nosso script de automa√ß√£o √© similar. Ele precisa saber:</p>
                <ul>
                    <li><strong>Onde est√° a lista de arquivos para transferir?</strong> (Esta lista geralmente est√° em uma planilha)</li>
                    <li><strong>Preciso de usu√°rio e senha para acessar pastas de rede?</strong> (√Äs vezes, drives de rede s√£o protegidos e precisam de credenciais)</li>
                </ul>
                <h3>Como ela coleta informa√ß√µes?</h3>
                <p>O componente "Interface de Entrada do Usu√°rio" usa uma ferramenta especial chamada <code>tkinter</code>. O <code>tkinter</code> √© uma parte padr√£o do Python que ajuda a criar janelas gr√°ficas simples e bot√µes.</p>
                <pre><code>import tkinter as tk
from tkinter import simpledialog

# Prepara o sistema de pop-up
root = tk.Tk()
root.withdraw() # Esconde a janela principal vazia

# Pergunta ao usu√°rio pelo caminho da planilha
sheet_path = simpledialog.askstring(
    title="Caminho da Planilha",
    prompt="Digite onde sua planilha est√° (ex: C:\\dados\\minhas_tarefas.xlsx):"
)

# Remove aspas se existirem
sheet_path = sheet_path.strip('"') if sheet_path else None</code></pre>
                <blockquote>A Interface de Entrada √© a face acolhedora do projeto, coletando informa√ß√µes cruciais atrav√©s de janelas pop-up simples para garantir que o script tenha todos os par√¢metros necess√°rios.</blockquote>
            </section>

            <hr>

            <section id="chapter2">
                <h1>Cap√≠tulo 2: Orquestrador de Fluxo de Trabalho</h1>
                <p>No Cap√≠tulo 1, voc√™ aprendeu como nossa ferramenta de automa√ß√£o coleta informa√ß√µes essenciais. Agora que o script tem suas instru√ß√µes, √© hora de falar sobre o "c√©rebro" da opera√ß√£o: o <strong>Orquestrador de Fluxo de Trabalho</strong>.</p>
                <h3>O que o Orquestrador resolve?</h3>
                <p>Imagine que voc√™ deu a um gerente de projeto uma longa lista de tarefas para completar. Este gerente precisa:</p>
                <ol>
                    <li>Percorrer a lista item por item</li>
                    <li>Atribuir cada tarefa ao membro certo da equipe</li>
                    <li>Acompanhar o que est√° feito, o que foi pulado, e o que deu errado</li>
                    <li>Garantir que todo o projeto avance suavemente</li>
                </ol>
                <h3>Fluxo de Processamento:</h3>
                <table>
                    <tr><th>Etapa</th><th>A√ß√£o</th><th>Resultado</th></tr>
                    <tr><td>1. Verifica√ß√£o</td><td>Checa status da tarefa</td><td>Pula se j√° OK</td></tr>
                    <tr><td>2. Abertura</td><td>Abre local de origem</td><td>Janela do Explorer</td></tr>
                    <tr><td>3. C√≥pia</td><td>Seleciona e copia item</td><td>Item na √°rea de transfer√™ncia</td></tr>
                    <tr><td>4. Destino</td><td>Abre local de destino</td><td>Pasta de destino aberta</td></tr>
                    <tr><td>5. Colagem</td><td>Cola o item copiado</td><td>Transfer√™ncia conclu√≠da</td></tr>
                </table>
                <pre><code># Loop principal do orquestrador
for i, row in df.iterrows():
    status_now = str(row.get("STATUS", "")).strip().upper()
    
    if status_now == "OK":
        skipped += 1
        continue
    
    try:
        # Executa transfer√™ncia
        win_src = open_path(src, username, password)
        copy_selection(not is_file(src))
        win_dst = open_path(dst, username, password)
        paste_in_folder()
        
        df.at[i, "STATUS"] = "OK"
        processed += 1
    except Exception as e:
        df.at[i, "STATUS"] = "ERRO"
        errors += 1</code></pre>
                <blockquote>O Orquestrador √© o maestro que coordena todos os componentes, garantindo que cada transfer√™ncia seja executada na ordem correta e com tratamento adequado de erros.</blockquote>
            </section>

            <hr>

            <section id="chapter3">
                <h1>Cap√≠tulo 3: Gerenciador de Dados de Planilha</h1>
                <p>O Gerenciador de Dados de Planilha √© o "bibliotec√°rio" do projeto. Seu trabalho √© lidar eficientemente com todas as informa√ß√µes da sua planilha, garantindo que o resto do script tenha instru√ß√µes precisas e atualizadas.</p>
                <h3>O que o Gerenciador resolve?</h3>
                <p>Imagine que suas tarefas de transfer√™ncia est√£o escritas em uma longa lista. Para nosso script de automa√ß√£o funcionar, ele precisa:</p>
                <ul>
                    <li><strong>Ler a Lista:</strong> Abrir o arquivo da planilha e entender todas as linhas e colunas</li>
                    <li><strong>Organizar Informa√ß√µes:</strong> Extrair informa√ß√µes espec√≠ficas como "de onde copiar" e "para onde colar"</li>
                    <li><strong>Atualizar Progresso:</strong> Se uma tarefa for conclu√≠da, precisa ser marcada como "feita"</li>
                    <li><strong>Salvar Altera√ß√µes:</strong> Garantir que todas as marca√ß√µes sejam salvas de volta na planilha</li>
                </ul>
                <h3>Estrutura da Planilha:</h3>
                <table>
                    <tr><th>Coluna</th><th>Fun√ß√£o</th><th>Exemplo</th></tr>
                    <tr><td>COPIAR</td><td>Caminho de origem</td><td>C:\Documentos\Relatorio.pdf</td></tr>
                    <tr><td>COLAR</td><td>Caminho de destino</td><td>\\RedeCompartilhada\Relatorios\</td></tr>
                    <tr><td>STATUS</td><td>Estado da transfer√™ncia</td><td>OK, ERRO ou vazio</td></tr>
                </table>
                <pre><code>import pandas as pd

# Carregamento da planilha
if sheet_path.lower().endswith(".xlsx"):
    df = pd.read_excel(sheet_path, dtype=str, engine="openpyxl")
elif sheet_path.lower().endswith(".csv"):
    df = pd.read_csv(sheet_path, dtype=str)

# Normaliza√ß√£o de colunas
df.columns = [str(c).upper() for c in df.columns]
if "STATUS" not in df.columns:
    df["STATUS"] = ""</code></pre>
                <blockquote>O Gerenciador de Planilhas utiliza a poderosa biblioteca pandas para ler, organizar e atualizar eficientemente os dados das tarefas de transfer√™ncia.</blockquote>
            </section>

            <hr>

            <section id="chapter4">
                <h1>Cap√≠tulo 4: Motor de Automa√ß√£o UI</h1>
                <p>O Motor de Automa√ß√£o UI s√£o as "m√£os e olhos" do script para a interface gr√°fica do seu computador. Ele permite que nosso script de automa√ß√£o aja como um usu√°rio humano, imitando suas teclas e movimentos do mouse.</p>
                <h3>O que o Motor resolve?</h3>
                <p>Imagine que voc√™ precisa copiar manualmente um arquivo de <code>C:\Relatorios\Mensal.xlsx</code> para <code>\\RedeCompartilhada\Arquivos\</code>. Voc√™ faria:</p>
                <ol>
                    <li>Abrir o Explorador de Arquivos</li>
                    <li>Navegar para <code>C:\Relatorios\</code></li>
                    <li>Clicar em <code>Mensal.xlsx</code></li>
                    <li>Pressionar <code>Ctrl + C</code> (Copiar)</li>
                    <li>Navegar para <code>\\RedeCompartilhada\Arquivos\</code></li>
                    <li>Pressionar <code>Ctrl + V</code> (Colar)</li>
                </ol>
                <h3>Bibliotecas do Motor:</h3>
                <table>
                    <tr><th>Biblioteca</th><th>Fun√ß√£o</th><th>Uso Principal</th></tr>
                    <tr><td>pyautogui</td><td>As "M√£os"</td><td>Simula teclas e cliques do mouse</td></tr>
                    <tr><td>pygetwindow</td><td>Os "Olhos"</td><td>Encontra e controla janelas espec√≠ficas</td></tr>
                </table>
                <pre><code>import pyautogui as pg
import pygetwindow as gw

def run_command(cmd: str):
    pg.hotkey("winleft", "r")  # Win + R
    time.sleep(0.4)
    pg.write(cmd, interval=0.02)  # Digita o comando
    pg.press("enter")
    time.sleep(2)
    return gw.getActiveWindow()

def copy_selection(is_folder: bool):
    if is_folder:
        pg.hotkey("ctrl", "a")  # Seleciona tudo
    pg.hotkey("ctrl", "c")      # Copia
    time.sleep(0.5)</code></pre>
                <blockquote>O Motor de Automa√ß√£o UI √© o executor ativo que usa pyautogui como "m√£os" e pygetwindow como "olhos" para interagir com a interface gr√°fica do sistema.</blockquote>
            </section>

            <hr>

            <section id="chapter5">
                <h1>Cap√≠tulo 5: Handler de Di√°logos do Windows</h1>
                <p>O Handler de Di√°logos do Windows √© um "solucionador de problemas" especializado para o processo de automa√ß√£o. Seu trabalho √© <strong>detectar e interagir automaticamente com janelas pop-up cruciais</strong> que podem interromper a transfer√™ncia.</p>
                <h3>O que o Handler resolve?</h3>
                <p>Imagine que voc√™ est√° tentando copiar centenas de arquivos automaticamente, mas ent√£o encontra obst√°culos:</p>
                <ul>
                    <li><strong>Acesso √† Rede:</strong> O script tenta abrir uma pasta em um drive de rede, e um di√°logo "Seguran√ßa do Windows" aparece pedindo usu√°rio e senha</li>
                    <li><strong>Arquivos Duplicados:</strong> O script tenta colar um arquivo, mas j√° existe um arquivo com o mesmo nome no destino</li>
                </ul>
                <h3>Di√°logos Suportados:</h3>
                <table>
                    <tr><th>Tipo de Di√°logo</th><th>T√≠tulos Reconhecidos</th><th>A√ß√£o</th></tr>
                    <tr><td>Login de Rede</td><td>"Seguran√ßa do Windows", "Windows Security"</td><td>Digita credenciais</td></tr>
                    <tr><td>Substituir Arquivo</td><td>"Substituir ou Ignorar Arquivos"</td><td>Pressiona Enter</td></tr>
                    <tr><td>Controle UAC</td><td>"Controle de Conta de Usu√°rio"</td><td>Confirma a√ß√£o</td></tr>
                </table>
                <pre><code>def login_popup(username: str, password: str):
    if not username or not password:
        return
    titles = [
        "Seguran√ßa do Windows", "Windows Security",
        "Credenciais de Rede", "Network Credentials"
    ]
    for _ in range(60):
        for t in titles:
            if gw.getWindowsWithTitle(t):
                pg.write(username)
                pg.press("tab")
                pg.write(password)
                pg.press("enter")
                time.sleep(1.5)
                return
        time.sleep(0.15)</code></pre>
                <blockquote>O Handler de Di√°logos atua como uma rede de seguran√ßa proativa, detectando e resolvendo automaticamente pop-ups comuns do sistema para manter a automa√ß√£o funcionando sem interrup√ß√µes.</blockquote>
            </section>

            <hr>

            <section id="chapter6">
                <h1>Cap√≠tulo 6: Logging e Relat√≥rios Operacionais</h1>
                <p>O componente de Logging e Relat√≥rios √© o "escriba" e "rep√≥rter" do projeto. Ele registra diligentemente tudo importante que acontece durante o trabalho da automa√ß√£o em um arquivo de log especial e compila um resumo claro no final.</p>
                <h3>O que o Logging resolve?</h3>
                <p>Quando uma automa√ß√£o roda, especialmente uma que executa muitas a√ß√µes, √© crucial ter um registro claro de suas atividades. Sem logging e relat√≥rios, voc√™ ficaria adivinhando:</p>
                <ul>
                    <li><strong>Ela iniciou?</strong> Ainda est√° rodando?</li>
                    <li><strong>Quais arquivos foram processados?</strong></li>
                    <li><strong>Houve erros?</strong> Se sim, <em>onde</em> aconteceram?</li>
                    <li><strong>Quantos itens foram pulados?</strong></li>
                </ul>
                <h3>Estrutura do Log:</h3>
                <table>
                    <tr><th>Tipo de Entrada</th><th>Formato</th><th>Exemplo</th></tr>
                    <tr><td>Info</td><td>[TIMESTAMP] - [A√á√ÉO]</td><td>2025-07-04 20:45:43 - [2/5] Copiando arquivo...</td></tr>
                    <tr><td>Skip</td><td>[TIMESTAMP] - [SKIP]</td><td>2025-07-04 20:45:43 - [SKIP] Linha 1 j√° OK</td></tr>
                    <tr><td>Erro</td><td>[TIMESTAMP] - [ERRO]</td><td>2025-07-04 20:45:43 - Linha 3 erro: Acesso negado</td></tr>
                </table>
                <pre><code>import logging
from pathlib import Path

# Configura√ß√£o do sistema de logging
log_file = Path(sheet_path).with_name("transfer_log.txt")
logging.basicConfig(
    filename=log_file,
    level=logging.INFO,
    format="%(asctime)s - %(message)s",
    datefmt="%Y-%m-%d %H:%M:%S",
    encoding="utf-8"
)

# Durante o processamento
logging.info(f"[{i+1}/{len(df)}] Copiando {src} ‚Üí {dst}")
logging.error(f"Linha {i+1} erro: {e}")</code></pre>
                <blockquote>O sistema de Logging cria um registro detalhado de todas as opera√ß√µes com timestamps, permitindo transpar√™ncia total e facilitando a solu√ß√£o de problemas em caso de falhas.</blockquote>
            </section>
        </main>
    </div>

    <footer>
        <p>&copy; 2025 Transfer Automation. Todos os direitos reservados. | <a href="https://github.com/transfer-automation" target="_blank">Visite nosso GitHub</a></p>
    </footer>

    <script src="https://unpkg.com/mermaid@10.9.1/dist/mermaid.min.js"></script>
    <script src="script.js"></script>
</body>
</html>